<%@page import="cn.iscas.nfsplatform.pojo.UserBriefModel"%>
<%@page import="cn.iscas.nfsplatform.pojo.UserListModel"%>
<%@page import="cn.iscas.nfsplatform.pojo.ToolBriefModel"%>
<%@page import="java.util.List"%>
<%@page import="cn.iscas.nfsplatform.pojo.ToolListModel"%>
<%@ page language="java" contentType="text/html; charset=utf-8"
	pageEncoding="utf-8"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://"
			+ request.getServerName()
			+ path + "/";
	String username=request.getSession().getAttribute("username").toString();
	Object userid=request.getSession().getAttribute("userid");
	
	
	UserListModel userList = (UserListModel)request.getAttribute("userslist");
	List<UserBriefModel> users = userList.getUsers();
	
	ToolListModel userTolls = (ToolListModel)request.getAttribute("toolslist");
	List<ToolBriefModel> tools = userTolls.getTools();	
%>
<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8"/>
	<title>NFS平台集成管理界面</title>
	
	<link rel="stylesheet" href="../css/layout.css" type="text/css" media="screen" />
	<!--[if lt IE 9]>
	<link rel="stylesheet" href="css/ie.css" type="text/css" media="screen" />
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<script type="text/javascript"
	src="../script/jsPlumb/jquery-1.9.0.js"></script>
	<script src="../js/hideshow.js" type="text/javascript"></script>
	<script src="../js/jquery.tablesorter.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="../js/jquery.equalHeight.js"></script>
	<script type="text/javascript">
	$(document).ready(function() 
    	{ 
      	  $(".tablesorter").tablesorter(); 
   	 } 
	);
	$(document).ready(function() {

	//When page loads...
	$(".tab_content").hide(); //Hide all content
	$("ul.tabs li:first").addClass("active").show(); //Activate first tab
	$(".tab_content:first").show(); //Show first tab content

	//On Click Event
	$("ul.tabs li").click(function() {

		$("ul.tabs li").removeClass("active"); //Remove any "active" class
		$(this).addClass("active"); //Add "active" class to selected tab
		$(".tab_content").hide(); //Hide all tab content

		var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to identify the active tab + content
		$(activeTab).fadeIn(); //Fade in the active ID content
		return false;
	});

});
    </script>
    <script type="text/javascript">
    $(function(){
        $('.column').equalHeight();
    });
</script>

<script type="text/javascript" src="<%=basePath%>script/gotourl.js"></script>
<script type="text/javascript" src="<%=basePath%>script/usertools.js"></script>

</head>



<body>

	<input style="display: none" value="<%=basePath%>" id="basePath" />
	<input style="display: none" value="<%=userid%>" id="userId" />	
	
	<section id="main" class="module width_full" style="width: 95%;">

		<article class="module width_full">
		<header><h3 class="tabs_involved">工具信息维护</h3>
		<ul class="tabs">
   			<li><a href="#tab1">平台工具列表</a></li>
    		<li><a href="#tab2">工具登录设置</a></li>
		</ul>
		</header>

		<div class="tab_container">
			<div id="tab1" class="tab_content">
			<table class="tablesorter" cellspacing="0" id="toolstable"> 
			<thead> 
				<tr> 
   					<th></th>
    				<th>工具名称</th> 
    				<th>工具地址</th> 
    				<th>工具描述</th> 
    				<th>操作</th> 
				</tr> 
			</thead> 
			<tbody> 
				
					<%
						for(ToolBriefModel tool : tools){
					%>
					<tr  class='choosedTools'> 
					<%	
						boolean flag = false;
					    for(UserBriefModel userinfor : users){
					    	if(userinfor.getToolid() == tool.getId()){
					    		flag = true;
					    		break;
					    	}
					    }	
					%>

					<%
						if(flag == true){
					%>
							<td><input type="checkbox" class='ckbox' checked="checked"></td> 
					<%
						}else{
					%>
							<td><input type="checkbox" class='ckbox'></td> 
					<%
						}
					%>
							<td style='display: none;' class='latenttoolids'><%=tool.getId() %></td>
		    				<td><%=tool.getName() %></td> 
		    				<td><%=tool.getTooladdress() %></td> 
		    				<td><%=tool.getDescription() %></td> 
		    				<td><input type="image" src="../images/icn_edit.png" title="编辑"></td>
	    			</tr>
	    			<%
	    				}
					%> 
 					<tr>
 						<td></td>
 						<td></td>
 						<td></td>
 						<td></td>
 						<td><input type="submit" onclick="updateSelfTools()" value="提交" class="alt_btn"></td>
 					</tr>
			</tbody> 
			</table>
			</div><!-- end of #tab1 -->
			
			<div id="tab2" class="tab_content">
			<table class="tablesorter" cellspacing="0"> 
			<thead> 
				<tr> 
    				<th>工具名</th> 
    				<th>工具地址</th> 
    				<th>用户名</th> 
    				<th>密码</th>
    				<th>备注</th>
    				<th>操作</th> 
				</tr> 
			</thead> 
			<tbody>
			
			 	<%
			 		for(UserBriefModel userinfor : users){			 	
			 	%>
							 
				<tr> 
					<td style='display: none;'><%=userinfor.getId() %></td>
    				<td><%=userinfor.getToolname() %></td> 
    				<td><%=userinfor.getTooladdress() %></td> 
    				<td><input type="text" value="<%=userinfor.getUsername() %>" /></td>
    				<td><input type="text" value="<%=userinfor.getPassword() %>" /></td> 
    				<td><%=userinfor.getOtherinfor() %></td>  
    				<td><input type="image" src="../images/icn_edit.png" class="updateusertool" title="修改用户名密码"></td> 
				</tr> 
				
				<%
			 		}
				%>


			</tbody> 
			</table>

			</div><!-- end of #tab2 -->
			
		</div><!-- end of .tab_container -->
		
		</article><!-- end of content manager article -->
		
		
		<div class="clear"></div>
	</section>

</body>

</html>