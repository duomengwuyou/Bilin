<%@page import="cn.iscas.nfsplatform.pojo.CompanyBriefModel"%>
<%@page import="cn.iscas.nfsplatform.pojo.CompanyListModel"%>
<%@page import="cn.iscas.nfsplatform.pojo.UserBriefModel"%>
<%@page import="cn.iscas.nfsplatform.pojo.UserListModel"%>
<%@page import="java.util.List"%>
<%@ page language="java" contentType="text/html; charset=utf-8"
	pageEncoding="utf-8"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://"
			+ request.getServerName()
			+ path + "/";
	String username=request.getSession().getAttribute("username").toString();
	Object userid=request.getSession().getAttribute("userid");
	
	
	CompanyListModel companyResults = (CompanyListModel)request.getAttribute("companylist");
	List<CompanyBriefModel> companys = companyResults.getCompanys();
	
%>
<html lang="en">

<head>
	<meta charset="utf-8"/>
	<title>NFS平台集成管理界面</title>
	
	<link rel="stylesheet" href="../css/layout.css" type="text/css" media="screen" />
	<!--[if lt IE 9]>
	<link rel="stylesheet" href="css/ie.css" type="text/css" media="screen" />
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<script type="text/javascript"
	src="../script/jsPlumb/jquery-1.9.0.js"></script>
	<script src="../js/hideshow.js" type="text/javascript"></script>
	<script src="../js/jquery.tablesorter.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="../js/jquery.equalHeight.js"></script>
	
	
	<link href="<%=basePath%>css/bootstrap.css" rel="stylesheet">

	<script type="text/javascript"
		src="<%=basePath%>script/bootstrap.min.js"></script>
	<script type="text/javascript"
		src="<%=basePath%>script/jquery.elastic.source.js"></script>

	<script type="text/javascript">
	$(document).ready(function() 
    	{ 
      	  $(".tablesorter").tablesorter(); 
   	 } 
	);
	$(document).ready(function() {

	//When page loads...
	$(".tab_content").hide(); //Hide all content
	$("ul.tabs li:first").addClass("active").show(); //Activate first tab
	$(".tab_content:first").show(); //Show first tab content

	//On Click Event
	$("ul.tabs li").click(function() {

		$("ul.tabs li").removeClass("active"); //Remove any "active" class
		$(this).addClass("active"); //Add "active" class to selected tab
		$(".tab_content").hide(); //Hide all tab content

		var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to identify the active tab + content
		$(activeTab).fadeIn(); //Fade in the active ID content
		return false;
	});

});
    </script>
    <script type="text/javascript">
    $(function(){
        $('.column').equalHeight();
    });
</script>

<script type="text/javascript" src="<%=basePath%>script/gotourl.js"></script>
<script type="text/javascript" src="<%=basePath%>script/userrole.js"></script>

</head>



<body>

	<input style="display: none" value="<%=basePath%>" id="basePath" />
	<input style="display: none" value="<%=userid%>" id="userId" />	
	
	<section id="main" class="module width_full" style="width: 95%;">

	  <article class="module width_full">
		<header><h3 class="tabs_involved">公司信息维护</h3>
		<ul class="tabs">
   			<li><a href="#tab1">公司列表</a></li>
		</ul>
		</header>

		<div class="tab_container">
			<div id="tab1" class="tab_content">
			<table class="tablesorter" cellspacing="0" id="toolstable"> 
			<thead> 
				<tr> 
   					<th></th>
    				<th>公司名称</th> 
    				<th>公司描述</th> 
    				<th>公司角色数目</th> 
    				<th>操作</th> 
				</tr> 
			</thead> 
			<tbody> 
				
					<%
						for(CompanyBriefModel company : companys){
					%>
					<tr> 
							<td></td> 
		    				<td><%=company.getCompanyname() %></td> 
		    				<td><%=company.getDescription() %></td> 
		    				<td><%=company.getRolesize() %></td> 
		    				<td>
		    				<input type="image" onclick="deletecompanyimage('<%=company.getCompanyid() %>')" src="../images/icn_trash.png" title="删除公司信息">
		    				<input type="image" onclick="editcompanyimge('<%=company.getCompanyid() %>//<%=company.getCompanyname() %>//<%=company.getDescription() %>')" src="../images/icn_edit.png" title="编辑公司信息"  data-toggle="modal" data-target="#editCompanyModal">
		    				<input type="image" onclick="addgroupimage('<%=company.getCompanyid() %>//<%=company.getCompanyname() %>')" src="../images/icn_new_article.png" title="增加角色信息"  data-toggle="modal" data-target="#addGroupModal">
		    				<%
		    				   if(company.getRolesize() != 0){
		    				%>
		    				<input type="image" src="../images/icn_categories.png" onclick="showCompanyRoles('<%=company.getCompanyid() %>//<%=company.getCompanyname() %>')" title="查看所有角色信息">
		    				<%
		    				   }
		    				%>
		    				
		    				</td>
	    			</tr>
	    		   <%} %>
			</tbody> 
			</table>
			</div><!-- end of #tab1 -->
			
		  </div><!-- end of .tab_container -->
		
	    </article><!-- end of content manager article -->
		
		<div class="clear"></div>
		
	  
	   <div id="companyroles" style="display: none">	  
		  <article class="module width_full">
			<header><h3 class="tabs_involved" id="companyinfor"></h3></header>
	
				<div class="tab_container">
					<table class="tablesorter" cellspacing="0" id="toolstable"> 
					<thead> 
						<tr> 
		   					<th></th>
		    				<th>角色名称</th> 
		    				<th>角色描述</th>
		    				<th>权限数目</th> 
		    				<th>操作</th> 
						</tr> 
					</thead> 
					<tbody  id="userroleinfors"> 
		
					</tbody> 
					</table>
					
				</div>			
		 </article>		
		</div>
		<div class="clear"></div>
		
		
	   <div id="roleauthoritys" style="display: none">	  
		  <article class="module width_full">
			<header><h3 class="tabs_involved" id="roleinfor"></h3></header>
	
				<div class="tab_container">
					<table class="tablesorter" cellspacing="0" id="toolstable"> 
					<thead> 
						<tr> 
		   					<th></th>
		    				<th>权限名称</th> 
		    				<th>权限描述</th> 
		    				<th>操作</th> 
						</tr> 
					</thead> 
					<tbody  id="roleauthoritysinfors"> 
		
					</tbody> 
					</table>
					
				</div>			
		 </article>		
		</div>
		<div class="clear"></div>
		
	</section>
	
	
	    <!-- add group model -->
		<div class="modal fade" id="addCompanyRole" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
						<h4 class="modal-title" id="companyRoleLabel"></h4>
					</div>
						<div class="modal-body">
							
							<input type="text" id="companyid" style="width: 350px;display: none"> 
							<label for="service-name" class="control-label">角色名称</label> 
							<input type="text" class="form-control" id="groupname" style="width: 350px;"> 
							<br> 
							<label for="service-type" class="control-label">角色信息描述</label> 
							<input type="text" class="form-control" id="description" style="width: 350px;"> 
							<br> 
						</div>
						<div class="modal-footer">
							<button id="closeAddButton" type="button" class="btn btn-default" data-dismiss="modal">取消</button>
							<button id="addgroup" onclick="addcompanygroup()" type="button" class="btn btn-primary">确认</button>
						</div>
				</div>
				<!-- /.modal-content -->
			</div>
			<!-- /.modal-dialog -->
		</div>
		<!-- /.modal -->


</body>

</html>